function S4(){return(65536*(1+Math.random())|0).toString(16).substring(1)}function guid(){return S4()+S4()+"-"+S4()+"-"+S4()+"-"+S4()+"-"+S4()+S4()+S4()}function Sync(e,t,i){var o=t.config.adapter.collection_name?t.config.adapter.collection_name:"default",n=new RegExp("^("+o+")\\-(.+)$"),r=null;if("read"===e)if(t instanceof Backbone.Collection){var l=[];_.each(TAP.listProperties(),function(e){var t=e.match(n);null!==t&&l.push(TAP.getObject(e))}),r=l}else{var a=TAP.getObject(o+"-"+t.id);t.set(a),r=t.toJSON()}else"create"===e||"update"===e?(t.id||(t.id=guid(),t.set(t.idAttribute,t.id)),TAP.setObject(o+"-"+t.id,t.toJSON()||{}),r=t.toJSON()):"delete"===e&&(TAP.removeProperty(o+"-"+t.id),t.clear(),r=t.toJSON());r?(_.isFunction(i.success)&&i.success(r),"read"===e&&t.trigger("fetch")):_.isFunction(i.error)&&i.error(r)}var Alloy=require("alloy"),_=require("alloy/underscore")._,TAP=Ti.App.Properties;module.exports.sync=Sync,module.exports.beforeModelCreate=function(e){return e=e||{},e.columns=e.columns||{},e.defaults=e.defaults||{},("undefined"==typeof e.columns.id||null===e.columns.id)&&(e.columns.id="String"),e};